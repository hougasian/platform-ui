@use "config";
@use "mixins";
@use "utilities";
@use "variables";
@use "sass:color";
@use "sass:math";
@use "sass:map";

// Button
//
// Each button has a default button style. Color can be added to any button using a combination of background and text utilities.
//
// Add icons to buttons using [platform icons](https://github.com/ritterim/platform-icons) icons: `<i class="pi-plus"></i>`
//
// Styleguide Components.Button

// Default
//
// The default platform button. Usually paired visually with an icon. Can be the default size or large.
//
// - .button
// - .button .button--lg
//
// Markup:
// <button class="button mb-2">Basic Button</button>
// <button class="button mb-2">Add <i class="pi-plus"></i></button>
// <button class="button button--lg">Add <i class="pi-plus"></i></button>
//
// Styleguide Components.Button.Default

// Secondary
//
// The secondary platform button. Always a round button paired with a Platform icon. Can be the default size or large.
//
// - .button
// - .button .button--secondary
// - .button .button--secondary .button--lg
//
// Markup:
// <button class="button button--secondary"><i class="pi-download"></i></button>
//
// Styleguide Components.Button.Secondary

// Secondary - Text
//
// If you want to use the secondary button for the look and hover effect, but you need to include text, you can.
// Include the class `has-text` on the secondary button. So the classes tould be, `button button--secondary has-text`.
// What this does is add `width: auto` and a little padding for the text.
//
// If you want to display text only on hover, add a data attribute named `data-button-text`, this will insert the value of that attribute on hover.
//
// - .button
// - .button .button--secondary
// - .button .button--secondary .has-text
//
// Markup:
// <div class="button-group">
//   <button class="button button--secondary has-text">Open <i class="pi-download"></i></button>
//   <button class="button button--secondary" data-button-text="Download"><i class="pi-download"></i></button>
//   <button class="button button--secondary loading" data-button-text="Download"><i class="pi-download"></i></button>
// </div>
//
// Weight: 4
//
// Styleguide Components.Button.SecondaryText

// Post
//
// Used exclsively in Post, or blog, content imported into the platform. e.g., CRM dashboard.
//
// - .button .button--post
// - .button .button--post .button--lg
//
// Markup:
// <button class="button button--post mb-2">Post Button</button>
// <button class="button button--post button--lg">Large Post Button</button>
//
// Styleguide Components.Button.Post

// Group
//
// Evenly space any group of buttons.
//
// - .button--group
//
// Markup:
// <div class="button-group">
//   <a class="button button--secondary"><i class="pi-download"></i></a>
//   <a class="button button--secondary"><i class="pi-lock"></i></a>
//   <a class="button button--secondary"><i class="pi-save"></i></a>
// </div>
//
// Styleguide Components.Button.Group

// Loading
//
// Buttons with a loading icon. Example for form submissions.
//
//
// Markup:
// <div class="button-group">
//   <button class="button loading mb-2" aria-label="Loading...">
//     Submit
//     <span class="sr-only">Loading...</span>
//   </button>
//   <button class="button button--lg loading mb-2" aria-label="Loading...">
//     Submit
//     <span class="sr-only">Loading...</span>
//   </button>
//   <button class="button button--secondary loading mb-2" aria-label="Download" aria-label="Loading...">
//     <i class="pi-download" aria-hidden="hidden"></i>
//     <span class="sr-only">Loading...</span>
//   </button>
//   <button class="button button--post loading mb-2" aria-label="Loading...">
//     Submit
//     <span class="sr-only">Loading...</span>
//   </button>
// </div>
//
// Notice: For styleguide purposes all of the code is rendered here. The things that should be
// toggled are the `aria-label="Loading"` and the text in the button. So for example, on
// submit, you would add `<span class="sr-only">Loading...</span>` the class
// `sr-only` is key to prevent the button from changin size.
//
// Styleguide Components.Button.Loading

// Accessibility
//
// For our links that should look like buttons, and contain an icon, we need to add specific
// `aria-roles` for accessibility.
// These are links that look like buttons but do not have the same html.
//
//
// Markup:
// <a class="button button--secondary" role="button" aria-label="Download">
//  <i class="pi-download" aria-hidden="hidden"></i>
// </a>
//
// Styleguide Components.Button.Accessibility

// Active
//
// By adding the class `active` to a button, the button's hover effect is mimicked.
//
// Markup:
// <button class="button mb-2">Add <i class="pi-plus" aria-hidden="hidden"></i></button>
// <button class="button button--lg active">Add <i class="pi-plus" aria-hidden="hidden"></i></button>
// <div class="button-group mt-4">
//   <a class="button button--secondary" role="button" aria-label="Download">
//     <i class="pi-download" aria-hidden="hidden"></i>
//   </a>
//   <a class="button button--secondary active" role="button" aria-label="locked">
//     <i class="pi-lock" aria-hidden="hidden"></i>
//   </a>
// </div>
//
// Styleguide Components.Button.Active

// Filter
//
// The filter button uses the med-blue background set in the brand-colors map. 
//
// Markup:
// <div class="button-group">
//   <a class="button button--filter">Clients</a>
//   <a class="button button--filter">Lead</a>
//   <a class="button button--filter">Prospect</a>
// </div>
//
// Styleguide Components.Button.Filter

.button {
  align-items: center;
  background-color: config.$button-primary-background;
  border: 1px solid color.adjust(map.get(variables.$greyscale, 'light'), $lightness: math.percentage(config.$hue-threshold * 2));
  border-radius: config.$button-border-radius;
  color: config.$button-primary-color;
  cursor: pointer;
  display: flex;
  font-family: map.get(config.$fonts, 'base');
  font-size: map.get(config.$fonts, 'size');
  justify-content: center;
  padding: config.$button-primary-padding;
  transition: config.$transitions;
  white-space: nowrap;

  &.active,
  &:hover {
    background-color: config.$button-secondary-background;
    border-color: inherit;
    color: config.$button-secondary-color;
  }

  &:disabled {
    background-color: color.adjust(map.get(variables.$greyscale, 'light' ), $lightness: math.percentage(config.$hue-threshold));
    cursor: not-allowed;
    opacity: .7;
    pointer-events: none;
  }

  &.loading {
    align-items: center;
    overflow: hidden;
    pointer-events: none;
    position: relative;

    &:before {
      background-color: config.$button-secondary-background;
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    &:not([data-button-text]) {
      &:after {
        @extend %pui-loader;
        @include mixins.square(variables.$spacer);
        box-sizing: border-box;
        content: "";
        display: block;
        border-color: map.get(config.$loader-colors, 'inverted');
        border-top-color: map.get(config.$loader-colors, 'inverted-top');
        left: 50%;
        margin-left: -.5rem;
        margin-top: -.5rem;
        position: absolute;
        top: 50%;
      }
    }
  }

  i {
    margin: 0 map.get(variables.$spacers, 1);
  }

  [aria-hidden="hidden"] {
    pointer-events: none;
  }

  &:not(.button--secondary):not(.mobile-menu-action):not(.close-action) {

    i {
      @include mixins.breakpoint(lg-tablet, max) {
        display: none;
      }
    }
  }

  &--secondary {
    background-color: config.$button-secondary-background;
    border: 1px solid config.$button-secondary-background;
    color: config.$button-secondary-color;
    border-radius: config.$button-border-radius * 100;
    padding: 0;
    width: 2rem;
    height: 2rem;
    @extend %flex-center;

    &.active,
    &:hover {
      background-color: color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold)));
      box-shadow: 0 0 0 .3rem color.adjust(config.$button-secondary-background, $lightness: math.percentage(config.$hue-threshold));
    }

    &[data-button-text] {
      transition: config.$transitions;

      &:after {
        display: none;
        width: 0;
        content: attr(data-button-text);
      }

      &:hover {
        width: auto;
        padding: 0 map.get(variables.$spacers, 1 );

        &:after {
          width: auto;
          display: inline-block;
          padding-right: map.get(variables.$spacers, 2 );
        }

      }

    }

    &.loading {

      &:before {
        background-color: color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold)));
        box-shadow: 0 0 0 .3rem color.adjust(config.$button-secondary-background, $lightness: math.percentage(config.$hue-threshold));
      }

      &[data-button-text] {
        background-color: color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold)));
        border-color: inherit;
        box-shadow: 0 0 0 .3rem color.adjust(config.$button-secondary-background, $lightness: math.percentage(config.$hue-threshold));
        padding: 0 map.get(variables.$spacers, 1 );
        width: auto;

        &:before {
          @extend %pui-loader;
          @include mixins.square(variables.$spacer);
          background-color: unset;
          box-sizing: border-box;
          box-shadow: none;
          content: '';
          display: block;
          border-color: config.$button-primary-background;
          border-top-color: color.adjust(map.get(variables.$greyscale, 'base' ), $lightness: math.percentage(config.$hue-threshold * 2));
          left: 0;
          margin: 0 map.get(variables.$spacers, 1 );
          position: relative;
          top: 0;
        }

        &:after {
          content: attr(data-button-text);
          width: auto;
          display: inline-block;
          padding-right: map.get(variables.$spacers, 2 );
        }

        i {
          display: none;
        }
      }
    }

    &.has-text {
      padding: 0 map.get(variables.$spacers, 2 );
      width: auto;

      @include mixins.breakpoint(lg-tablet, max) {
        font-size: 0;
        width: 2rem;

        i {
          font-size: initial;
        }
      }
    }
  }

  &--post {
    background-color: config.$button-secondary-background;
    border: 1px solid config.$button-secondary-background;
    color: config.$button-secondary-color;
    transition: config.$transitions;

    &.active,
    &:hover {
      background-color: color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold)));
      background-image: linear-gradient(45deg, config.$button-secondary-background, color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold * 2))));
    }

    &.loading {

      &:before {
        background-color: color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold)));
        background-image: linear-gradient(45deg, config.$button-secondary-background, color.adjust(config.$button-secondary-background, $lightness: math.percentage(-(config.$hue-threshold * 2))));
      }
    }
  }

  &--lg {
    font-size: map.get(variables.$font-percentage, 'lg');
    padding: config.$button-large-padding;

    &.loading {

      &:after {
        @include mixins.square(variables.$spacer * 1.5);
        margin-left: -.75rem;
        margin-top: -.75rem;
      }
    }
  }

  &--filter {
    border-color: config.$button-filter-color;
    color: config.$button-filter-color;

    &.active,
    &:hover {
      background-color: config.$button-filter-color;
      color: config.$button-secondary-color;
    }
  }
}

.button-group {
  display: flex;
  align-items: center;

  .button {
    margin: config.$button-group-margin;

    &:first-child {
      margin-left: 0;
    }

    &:last-child {
      margin-right: 0;
    }
  }
}
